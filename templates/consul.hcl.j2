datacenter = "{{ consul_dc_name }}"
data_dir = "{{ consul_data_dir }}"
encrypt = "{{ consul_encrypt_key }}"

acl = {
  enabled = true
  default_policy = "deny"
  enable_token_persistence = true
  down_policy = "extend-cache"
}
 
tls {
  defaults {
    ca_file = "{{ consul_config_dir }}/certs/consul-agent-ca.pem"
{% if consul_server %}
    cert_file = "{{ consul_config_dir }}/certs/{{ consul_dc_name }}-server-{{ consul_domain }}-0.pem"
    key_file = "{{ consul_config_dir }}/certs/{{ consul_dc_name }}-server-{{ consul_domain }}-0-key.pem"
 {% endif %}
    verify_incoming = true
    verify_outgoing = true
  }
  internal_rpc {
    verify_server_hostname = true
  }
}
 
retry_join = ["{{ consul_join_ips | join('","') }}"]  # This must be a public IP(s) used for all servers/clients in the datacenter
